> 在使用一些小内存单片机时，无法加入操作系统，也没有必要使用操作系统。这时我们需要一种小系统框架，来帮助我们简化逻辑，简便维护。

## 任务管理系统
[【开源】TMT任务管框架，让写裸机程序也可以很丝滑！-哔哩哔哩](https://b23.tv/i5zFJ7o).
[TMT: 一个面向对象封装的适用于裸机的前后台系统框架 (gitee.com)](https://gitee.com/gevico/tmt)

实现一个类似这样的任务管理器，支持任务的添加与删除，支持不同延时。

这种方式实现的任务管理不支持任务中断跳转，任务在循环中依旧是逐个执行，遇到耗时过长的任务，可能使其他任务的运行周期延长。

对于高频少量的更新任务，可以在定时器的中断函数中执行。

## 系统管理

建立XXX_system库，调用各个模块，实现系统逻辑

建立debug库，为各个模块提供debug信息输出

各个模块提供init（start）、功能函数，为系统提供数据返回，操作执行的功能

## TEST移植
建立test移植模块，与system平级，调用各个外设，各外设同时包含test_config，通过宏定义控制各模块是否启用
测试时屏蔽正常代码，启用test函数
congfig配合test，通过逐步启用各模块，控制test运行不同测试函数

## .h文件包含原则

[头文件组织原则 -知乎](https://zhuanlan.zhihu.com/p/345399752?utm_psn=1830187395955425280)

源文件：功能实现，实体变量
头文件：各类声明，外部调用

- 仅供源文件使用的代码不能出现在头文件中，包括变量、include、函数声明、宏定义等
- 在.h文件内的include，应满足广泛性、会被上层调用
- 减少头文件的嵌套和交叉引用，头文件仅包含其真正需要显式包含的头文件。即其内包含本头文件使用到的类型或其他定义
- 使用层次化和模块化的软件开发模型。每个模块只能使用所在层和下一层模块提供的接口。

上下层文件存在耦合时，可用指针传导必要接口。例如，OS提供按键逻辑，key需要将按键逻辑置于回调函数中，key需要调用OS，这违反了上下层调用关系。可在key中编写init函数，OS通过init函数将按键逻辑传至key中。











